<!DOCTYPE html>

<html> 
<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="description" content="M2hj.GitHub.io : ">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densitydpi=medium-dpi" />
	<script type="text/javascript">
		// 마켓 주소 세팅을 미리 해두었습니다. a=안드로이드, i=iOS
		var market_a = "market://details?id=com.nhn.android.navercafe";
		var market_i = "https://itunes.apple.com/app/id420615104?mt=8";
		 
		var currentOS;
		var mobile = (/iphone|ipad|ipod|android/i.test(navigator.userAgent.toLowerCase()));
		 
		if (mobile) {
			// 유저에이전트를 불러와서 OS를 구분합니다.
			var userAgent = navigator.userAgent.toLowerCase();
			if (userAgent.search("android") > -1)
				currentOS = "android";
			else if ((userAgent.search("iphone") > -1) || (userAgent.search("ipod") > -1)
						|| (userAgent.search("ipad") > -1))
				currentOS = "ios";
			else
				currentOS = "else";
		} else {
			// 모바일이 아닐 때
			currentOS = "nomobile";
		}
			 
		 
		 
		// 바로재생, 다운로드 버튼 클릭
		function checkAppInstall() {
			// 앱에 설정해놓은 커스텀 스킴. 여기선 "customScheme"
			var url = "customScheme://blahblah~";
			 
			if(currentOS == "android") {
				    if (userAgent.match(/Chrome/)) {
         // 안드로이드의 크롬에서는 intent만 동작하기 때문에 intent로 호출해야함
         setTimeout(function() {
              location.href = "intent://specific_cafe?cafeId=27950174#Intent; scheme=navercafe; action=..;category=..; package=com.nhn.android.navercafe; end;";
         }, 1000);
    } else {
        // 크롬 이외의 브라우저들
        setTimeout(
           function() {
              if ((new Date()).getTime() - visitedAt < 2000) {
                 location.href = "market://details?id=com.nhn.android.navercafe";
              }
          }, 500);

          var iframe = document.createElement('iframe');
          iframe.style.visibility = 'hidden';
          iframe.src = 'navercafe://specific_cafe?cafeId=27950174';
          document.body.appendChild(iframe);
          document.body.removeChild(iframe); // back 호출시 캐싱될 수 있으므로 제거
     }
			} else if(currentOS == "ios") {
			 var visitedAt = (new Date()).getTime(); // 방문 시간
			 setTimeout(
      function() {
          if ((new Date()).getTime() - visitedAt < 2000) {
               location.href = "https://itunes.apple.com/app/id420615104?mt=8";
          }
       }, 500);

   setTimeout(function() { 
        location.href = "navercafe://specific_cafe?cafeId=27950174";
    }, 0);
			}
		 
			return false;
		}
		 
		// 마켓 이동
		function goMarket() {
			if(currentOS == "android") {
				location.href=market_a;
			} else if(currentOS == "ios") {
				location.href=market_i;
			} else {
				/* 기타 OS일 때 */
			}
		}
	</script>
	<style>
		.big { font-size : 5em; }
	</style>
	<meta http-equiv="refresh" content="0;url=http://m2hj.github.io" />
</head>

<body>
	<div>메이플스토리2 메인카페 - 메투하자 이동 웹 v.0.3.17</div>
	<div>잠시 후 5초 후에 바로 이동됩니다.</div>
	<div><a href="#" onclick="return checkAppInstall()">네이버 카페 앱으로 보기</button><br></div>
 
	<!-- display 속성을 두어 숨어있는 div를 미리 만들어 놓습니다. 이 div에 iframe이 생성됩니다. -->
	<div id="invisible_div" style="display:none;"></div>
</body>  
</html>
